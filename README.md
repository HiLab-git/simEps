# Semi-Supervised Defect Segmentation with Pairwise Similarity Map Consistency and Ensemble-Based Cross-Pseudo Labels (simEps)
In this study, we propose a novel method based on pairwise similarity map consistency with ensemble-based cross-pseudo labels for semisupervised defect segmentation that uses limited labeled samples while exploiting additional label-free samples. The proposed approach uses three network branches that are regularized by pairwise similarity map consistency, and each of them is supervised by the pseudo labels generated by ensemble of predictions of the other two networks for the unlabeled samples. The proposed method achieved significant performance improvement over the baseline of learning only from the labeled images and the current stateof-the-art semi-supervised methods.\
![Overall frame work of the proposed method](/ext_data/main-architecture.pdf)\
![Similarity consistency](/ext_data/similarity_loss.pdf)
# Full paper source:
You can read the details about the methods, implementation, and results from: (https://ieeexplore.ieee.org/document/9994033)

**Please cite ourwork as follows:**
```
@article{sime2022semi,
  title={Semi-Supervised Defect Segmentation with Pairwise Similarity Map Consistency and Ensemble-Based Cross-Pseudo Labels},
  author={Sime, Dejene M and Wang, Guotai and Zeng, Zhi and Wang, Wei and Peng, Bei},
  journal={IEEE Transactions on Industrial Informatics},
  year={2022},
  publisher={IEEE}
}
```
## Python >= 3.6
PyTorch >= 1.1.0
PyYAML, tqdm, tensorboardX
## Data Preparation
Download datasets. There are 3 datasets to download:
* NEU-SEG dataset
* DAGM dataset
* MT (Magnetic Tiles) dataset

Put downloaded data into the following directory structure:
* data/
    * NEU-Seg/ ... # raw data of NEU-Seg
    * DAGM/ ...# raw data of DAGM
    * MT/ ...# raw data of MTiles
## Data loading and preparation 

## Visualization
The visualization of the segmetnation results for the baseline, selected semi-supervised methods and our proposed method with the NEU-Seg dataset is presented as follows.\
![Visualization of segmentation map](/ext_data/NEU-viz.pdf)\
![Multi-stage pairwise similarity map](/ext_data/similarity_map_viz.pdf)

## Acknowledgment

This repo borrowed many implementations from [SSL4MIS](https://github.com/HiLab-git/SSL4MIS)

## Contact
For any issue please contact me at djene.mengistu@gmail.com
